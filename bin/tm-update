#!/bin/bash

export LC_CTYPE=en_US.UTF-8

SCRIPT="$(basename "$0")"

if ! type svn >/dev/null 2>&1 ; then
    echo "$SCRIPT: svn: Command not found" >&2
    exit 2
fi

TM_DIR="$(osascript -e 'get POSIX path of (path to application support from local domain)')/TextMate"
if [[ ! -d "$TM_DIR" ]]; then
    echo "$SCRIPT: $TM_DIR: No such file or directory" >&2
    exit 2
fi

cd "$TM_DIR"
sudo svn update
osascript -e 'tell app "TextMate" to reload bundles'
