#!/bin/bash
#
# bash_prompt
# bash-specific prompting

# Helper definitions
PS_ARROW=">"
PS_DIRTY="*"
PS_FAIL="!"
PS_WINDOW=""
# if [[ -n "$WINDOW" ]]; then
#     PS_WINDOW="#$WINDOW:"
# fi

# Helper functions
autoload_from __git_ps1 "$HOME/.bash_completion.d/git-completion.bash"
__svn_ps1 () {
    if [[ -d '.svn' ]]; then
        local svnroot="$(svn info|/usr/bin/sed -n 's/^Repository Root: //p')"
        local svnpath="$(svn info|/usr/bin/sed -n 's/^URL: //p')"
        builtin echo -ne " ($(echo $svnpath | /usr/bin/sed -e "s|$svnroot/||" -e "s|/.*||"))"
    fi
}
__pwd_with_tilde () {
    echo $PWD | /usr/bin/sed -e "s:$HOME:~:"
}

# Set the prompt
PS1='\w$(__git_ps1)$(__svn_ps1)$PS_ARROW '


# Set terminal titles 
__term_func () {
    title "$is" "$USER@${HOSTNAME%.*}" "$(__pwd_with_tilde)"
}
PROMPT_COMMAND='__term_func'
